---
import BaseHead from "../components/BaseHead.astro";
import LangSwitcher from "../components/LangSwitcher.astro";

const { title, description } = Astro.props;

console.log("111222", title);
---

<html lang={Astro.currentLocale}>
  <head>
    <BaseHead {title} {description} />
    <!-- 先执行首帧主题脚本 -->
    <script is:inline>
      (() => {
        try {
          const raw = localStorage.getItem("ui"); // ⬅️ 确保与 pinia 持久化的 key 一致
          const sel = raw ? JSON.parse(raw).theme : "system";
          const prefersDark = window.matchMedia?.(
            "(prefers-color-scheme: dark)",
          ).matches;
          const actual =
            sel === "dark"
              ? "dark"
              : sel === "light"
                ? "light"
                : prefersDark
                  ? "dark"
                  : "light";
          if (actual === "dark") document.documentElement.classList.add("dark");
          document.documentElement.dataset.theme = actual;
        } catch {}
      })();
    </script>
  </head>
  <body class="font-sans antialiased text-gray-800 dark:(bg-zinc-900 text-zinc-100)">
    <header class="container mx-auto p-4 flex items-center justify-between">
      <a href={Astro.url.origin} class="text-xl font-bold">AstroVue</a>
      <nav class="flex items-center gap-3">
        <LangSwitcher />
      </nav>
    </header>
    <main class="container mx-auto p-4">
      <slot />
    </main>
    <footer class="container mx-auto p-4 text-center text-sm text-gray-500">
      © {new Date().getFullYear()} AstroVue. All rights reserved.
    </footer>
  </body>
</html>

<style is:global>
  :root {
    color-scheme: light;
  }
  .container {
    max-width: 1100px;
  }
</style>
